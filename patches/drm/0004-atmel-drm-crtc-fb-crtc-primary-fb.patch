From 4165191b2894cc4ce18cdd4eba3f6f6876186dbf Mon Sep 17 00:00:00 2001
From: Robert Nelson <robertcnelson@gmail.com>
Date: Fri, 18 Apr 2014 09:32:34 -0500
Subject: [PATCH 4/4] atmel: drm: crtc->fb -> crtc->primary->fb

Signed-off-by: Robert Nelson <robertcnelson@gmail.com>
---
 drivers/gpu/drm/atmel_hlcdc/atmel_hlcdc_crtc.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/drivers/gpu/drm/atmel_hlcdc/atmel_hlcdc_crtc.c b/drivers/gpu/drm/atmel_hlcdc/atmel_hlcdc_crtc.c
index 649fa19..a111d69 100644
--- a/drivers/gpu/drm/atmel_hlcdc/atmel_hlcdc_crtc.c
+++ b/drivers/gpu/drm/atmel_hlcdc/atmel_hlcdc_crtc.c
@@ -81,7 +81,7 @@ static void update_scanout(struct drm_crtc *crtc)
 	struct atmel_hlcdc_crtc *hlcdc_crtc = to_atmel_hlcdc_crtc(crtc);
 	struct drm_device *dev = crtc->dev;
 	struct atmel_hlcdc_drm_private *priv = dev->dev_private;
-	struct drm_framebuffer *fb = crtc->fb;
+	struct drm_framebuffer *fb = crtc->primary->fb;
 
 	struct drm_gem_cma_object *gem;
 	struct atmel_hlcd_dma_desc *desc = hlcdc_crtc->dma_descs[DMA_BASE];
@@ -188,7 +188,7 @@ static int atmel_hlcdc_crtc_page_flip(struct drm_crtc *crtc,
 		return -EBUSY;
 	}
 
-	crtc->fb = fb;
+	crtc->primary->fb = fb;
 	atmel_hlcdc_crtc->event = event;
 	update_scanout(crtc);
 	return 0;
@@ -397,7 +397,7 @@ static int atmel_hlcdc_crtc_mode_set(struct drm_crtc *crtc,
 	hlcdc_write(dev, ATMEL_LCDC_BASECFG0,
 		    LCDC_BASECFG0_BLEN_AHB_INCR16 | LCDC_BASECFG0_DLBO);
 
-	drm_fb_get_bpp_depth(crtc->fb->pixel_format, &depth, &bpp);
+	drm_fb_get_bpp_depth(crtc->primary->fb->pixel_format, &depth, &bpp);
 	hlcdc_write(dev, ATMEL_LCDC_BASECFG1,
 		    atmel_hlcdfb_get_rgbmode(dev->dev, depth, bpp));
 	hlcdc_write(dev, ATMEL_LCDC_BASECFG2, 0);
-- 
1.9.1

